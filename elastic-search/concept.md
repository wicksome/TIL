# Node

엘라스틱서치(es: elastic search)의 모든 인스턴스로, 독립적으로 동작 가능한 서버를 말한다.

**_노드 시작하는 동안 발생하는 액션_**
- 환경 변수와 dlasticsearch.yml 설정 파일에서 설정을 읽는다.
- 노드 이름은 설정 파일에 의해 설정되거나, 내부에서 만든 무작위 이름중 하나가 선택된다.
- 내부적으로 es 엔진은 현재 설치에서 사용 가능한 모든 모듈과 플러그인을 초기화한다.

**_노드 실행_**
- 노드는 그밖의 클러스터 맴버를 검색하고 index와 shard 상태를 확인한다.

**_클러스터에 2개 이상의 노드를 참여시키려면, 다음과 같은 규칙이 있다._**
- es의 버전이 같아야 한다.
- 클러스터 이름이 같아야 한다.
- 네트워크는 broadcast discovery(기본 설정)가 가능하도록 설정해야 한다.

**_일반적인 접근 방식_**
- 모든 클러스터 레벨의 액션을 주로 참조하는 master node와, 마스터 데이터 및 마스터 노드의 액션을 복제하는 그 밖의 노드, 즉 secondary node들을 사용한다.

write 작업 시 일관성을 유지하기 위해, 모든 업데이트 액션은 우선 마스터 노드에서 수행된 후에 보조 노드에서 복제된다.

다중 노드로 구성된 클러스터에서는 마스터 노드가 죽으면 **마스터 자격이 있는(master-dligible)**노드가 마스터 노드로 선출된다.마스터 선출은 엘라스틱서치 클러스터에서 자동 복구를 설정함으로써 가능하다.

**_non-data node(arbiter)& data node_**
- non-data node는 REST 응답을 비롯한 그 밖의 모든 검색 작업을 처리할 수 있다.
- 모든 액션 실행 시, 일반적으로 es는 map/reduce 처리 방법을 이용해 액션을 수행한다.
- non-data node는 기본 샤드(맵)에 액션을 분산하고, 최종 응답을 보낼 수 있도록 샤드 결과 수직/집계(리듀스)를 책임진다.
- facet, aggregation, 수집 결과와 캐싱(ex. scan/scroll 질의) 같은 작업을 하기 위해 많은 양의 RAM을 사용할 수 있다. 

- data node는 데이터를 저장할 수 있으며, Lucene(내부 es 엔진) 색인처럼 색인된 도큐먼트를 저장한 색인 샤드를 포함한다.
- 표준 설정을 사용하면, 노드는 결정권자이자 데이터 컨테이너다.
- 데이터가 전혀 없고 많은 RAM을 가진 간단한 결정권자 같은 노드들이 존재하는 것에 대한 클러스터 아키텍처에서는, 결정권자의 로컬 메모리 캐시를 사용해 데이터 노드에 필요한 자원을 줄이고 검색 시 성능을 높인다.

# Cluster

standalone으로 동작하는 여러 노드를 그룹화한 것으로 데이터의 분산과 공유를 할 수 있도록 서비스를 구성한다.


# Index

es에서 데이터를 저장하기 위한 장소로, RDBMS의 데이터베이스와 유사하다. index는 하나 또는 여러 개의 도큐먼트 타입을 가질 수 있다.

실제 소스 코드나 참조 문서에는 indice라는 용어가 사용되는데 index는 검색에서 포괄적인 의미인 색인 또는 색인 파일이고, indice는 es 내에서 물리적으로 사용되는 색인 또는 색인 파일이라고 보면 된다. 가존 검색엔진의 collection과 같은 의미가 indice다.

# Shard
