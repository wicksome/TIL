= Effective Java - ê°ì²´ ìƒì„±ê³¼ íŒŒê´´
Yeongjun Kim <opid911@gmail.com>
:revdate: 2017-02-10T00:00:00+09:00
:page-tags: java, effective-java 

[NOTE]
****
ì•„ë˜ ì±…ë¥¼ ì°¸ê³ í•˜ì—¬ í•™ìŠµí•œ ë‚´ìš©ì„ ì •ë¦¬/ê¸°ë¡í•œ í¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ì±…ì„ ì°¸ê³ í•˜ì‹œê¸° ë°”ë¼ë©°, ë¬¸ì œê°€ ìˆì„ ê²½ìš° ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.

- Joshua Bloch, ê°œì•ë§µì‹œ(ì˜®ê¸´ì´), Effective Java, 3/E, ì¸ì‚¬ì´íŠ¸, 2018.
- Joshua Bloch, ì´ë³‘ì¤€(ì˜®ê¸´ì´), Effective Java, 2/E, ì¸ì‚¬ì´íŠ¸, 2015.
****

'ì´í™í‹°ë¸Œ ìë°” 2íŒ'ì„ ê³µë¶€í•˜ê³ , 3íŒì´ ë‚˜ì™”ë‹¤ëŠ” ì–˜ê¸°ë¥¼ ë“£ê³  ë‹¤ì‹œ ë³´ë©´ì„œ ì •ë¦¬í•œ ë‚´ìš©ì„ ë³´ì™„í•˜ê³ ì í•œë‹¤.

[#item01]
== ê·œì¹™ 1. ìƒì„±ì ëŒ€ì‹  ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œë¥¼ ê³ ë ¤í•˜ë¼
:source-enumset: http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/file/7d1d5f4d019a/src/share/classes/java/util/EnumSet.java#l109
:dp-factory-method: https://wickso.me/java/design-pattern/factory-method-pattern
:dp-flyweight: https://wickso.me/java/design-pattern/flyweight-pattern
:item3: https://wickso.me/java/effective-java/03
:item4: https://wickso.me/java/effective-java/01-09#03
:item17: https://wickso.me/java/effective-java/01-09#03
:item20: https://wickso.me/java/effective-java/01-09#enum
:item34: https://wickso.me/java/effective-java/01-09#enum

**ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œ(static factory method)**ë€ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ëŠ” ë‹¨ìˆœí•œ static methodë¥¼ ë§í•œë‹¤. {dp-factory-method}[íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´]ê³¼ ë‹¤ë¥´ë‹¤.

[TIP]
.ê°ì²´? ì¸ìŠ¤í„´ìŠ¤? ì¸ìŠ¤í„´ìŠ¤í™”?
====
ë¹„ìŠ·í•œ ê°œë…ì´ì§€ë§Œ ì •í™•íˆ êµ¬ë³„í•˜ë©´ **ì¸ìŠ¤í„´ìŠ¤(instance)**ê°€ **ê°ì²´(object)**ë³´ë‹¤ í° ì˜ë¯¸ì´ë‹¤. 
ê°ì²´ëŠ” ì–´ë–¤ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•´ì„œ ë§Œë“¤ì–´ì§„ ê²ƒì„ ì˜ë¯¸í•œë‹¤.
ê·¸ë¦¬ê³  ê·¸ ê°ì²´ê°€ ë©”ëª¨ë¦¬ì— í• ë‹¹ë˜ì–´ ì‹¤ì œ ë©”ëª¨ë¦¬ë¥¼ ì°¨ì§€í•˜ëŠ” ê²ƒì„ ì¸ìŠ¤í„´ìŠ¤ë¼ê³  í•œë‹¤.  

ì•„ë˜ ì½”ë“œì—ì„œ ê°ì²´ì™€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ë³„í•´ë³´ì.

[source, java]
----
String str; // <1>
str = new String("Hello world"); // <2>
----
<1> `str` ì€ String í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ì²´ë¥¼ ì„ ì–¸í•œ ê²ƒì´ë‹¤. ì•„ì§ `str` ì— ë¬¸ìì—´ì´ í• ë‹¹ë˜ì–´ ìˆì§€ ì•Šì€ ìƒíƒœì´ë‹¤. 
<2> _new_ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ JVM(Java Virtual Machine)ì— ë°ì´í„°ê°€ ìƒì„±ëœ ê²ƒì„ ë³´ì—¬ì¤€ë‹¤. 
ë‹¤ì‹œ ë§í•´, ê°ì²´ `str` ì— "Hello world"ë¼ëŠ” ë¬¸ìì—´ì„ í• ë‹¹í•˜ì˜€ë‹¤(instantiate).
ì´ë ‡ê²Œ ê°ì²´ë¥¼ ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ì— í• ë‹¹í•˜ëŠ” ê³¼ì •ì„ **ì¸ìŠ¤í„´ìŠ¤í™”(instantiate)**ë¼ê³  í•œë‹¤.
ê·¸ë¦¬ê³  ì´ë ‡ê²Œ ì¸ìŠ¤í„´ìŠ¤í™”ëœ ê°ì²´ë¥¼ ì¸ìŠ¤í„´ìŠ¤ë¼ê³  ë¶€ë¥¸ë‹¤.
====


.í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì–»ëŠ” ë°©ë²•
* public ìƒì„±ì
+
[source, java]
----
public Boolean(String str) {
    this.value = "true".equalsIgnoreCase(str); 
}
----
+
[TIP]
.NPEë¥¼ í”¼í•˜ëŠ” ë°©ë²•
====
ìœ„ ì½”ë“œë¥¼ ë³´ë©´ `str` ì˜ _equalsIgnoreCase_ ê°€ ì•„ë‹Œ ë¬¸ì ì´í„°ëŸ´ì˜ equalsIgnoreCase ë¥¼ ì‚¬ìš©í•œë‹¤.
ì´ì™€ ê°™ì€ ë°©ë²•ì€ `str` ì´ null ì¼ ê²½ìš° ë°œìƒí•  NPE(NullPointException)ë¥¼ í”¼í•  ìˆ˜ ìˆë‹¤.
====
* ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œ
+
[source, java]
----
public static Boolean valueOf(boolean b) {
    return b ? Boolean.TRUE : Boolean.FALSE;
}
----

[NOTE]
.boxing ê³¼ unboxing
====
Javaì—ì„œ primitive typeê³¼ wrapper classëŠ” ì„œë¡œ boxing/unboxingì´ ê°€ëŠ¥í•˜ë‹¤. [.line-through gray]#`Boolean` í´ë˜ìŠ¤ë¥¼ ë³´ë‹¤ê°€ ê¶ê¸ˆí•´ì„œ ì¶”ê°€í•œë‹¤.#
[source, java]
----
// primitive
boolean b = (boolean)Boolean.TRUE; // <1>
// reference type
Boolean b = (Boolean)true; // <2>
Boolean b = true; // <3>
Boolean b = Boolean.valueOf(true);
----
<1> unboxing
<2> boxing
<3> auto boxing
====

[#advantage-of-static-factory-method]
=== ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œ ì¥ì 

`java.utils.Collections` í´ë˜ìŠ¤ì—ì„œ ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œì˜ ì¥ì ì´ ë§ì´ ë³´ì—¬ ì½”ë“œì˜ ì¼ë¶€ë¥¼ ì¶”ê°€í•˜ì˜€ë‹¤.

==== ì´ë¦„ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤

[source, java]
----
public static final <K,V> Map<K,V> emptyMap() { ... }
----

ìƒì„±ìì™€ ë‹¬ë¦¬ ë°˜í™˜ë˜ëŠ” ê°ì²´ì˜ íŠ¹ì„±ì„ ì˜ ì„¤ëª…í•œ ë©”ì„œë“œëª…ì„ í†µí•´ ì´í•´í•˜ê¸° ì‰¬ìš´ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

==== í˜¸ì¶œë  ë•Œë§ˆë‹¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒˆë¡œ ìƒì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤

[source, java]
----
public class Collections {
    public static final Map EMPTY_MAP = new EmptyMap<>();

    // static factory method
    public static final <K,V> Map<K,V> emptyMap() {
        return (Map<K,V>) EMPTY_MAP;
    }
}
----

ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë¯¸ë¦¬ ë§Œë“¤ì–´ ë†“ê±°ë‚˜ ì´ë¯¸ ë§Œë“  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìºì‹±í•˜ì—¬ ì¬ì‚¬ìš©í•˜ë©´ì„œ ë¶ˆí•„ìš”í•œ ì¸ìŠ¤í„´ìŠ¤í™”ë¥¼ í”¼í•  ìˆ˜ ìˆë‹¤. 
(íŠ¹íˆ ì¸ìŠ¤í„´ìŠ¤í™” ë¹„ìš©ì´ í°) ë™ì¼í•œ ê°ì²´ê°€ ìš”ì²­ë˜ëŠ” ì¼ì´ ì¦ì„ ë•Œ ì ìš©í•˜ë©´ ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ í•  ìˆ˜ ìˆë‹¤.
ì´ ê¸°ë²•ì„ í™œìš©í•œ ì¢‹ì€ ì‚¬ë¡€ë¡œ `Boolean.value(boolean)` ë¥¼ ë‘˜ ìˆ˜ ìˆìœ¼ë©° {dp-flyweight}[Flyweight íŒ¨í„´]ê³¼ ìœ ì‚¬í•˜ë‹¤. 

===== ì¸ìŠ¤í„´ìŠ¤ í†µì œ(instance-controlled) í´ë˜ìŠ¤
ë°˜ë³µì ì¸ ìš”ì²­ì—ë„ ê°™ì€ ì¸ìŠ¤í„°ìŠ¤ë¥¼ ë°˜í™˜í•˜ëŠ” ì •ì  íŒ©í„°ë¦¬ ë°©ì‹ì˜ í´ë˜ìŠ¤ëŠ” ì–´ë–¤ ì‹œì ì— ì–´ë–¤ ê°ì²´ê°€ ì–¼ë§ˆë‚˜ ì¡´ì¬í• ì§€ë¥¼ ì •ë°€í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆë‹¤. 
ì¸ìŠ¤í„´ìŠ¤ í†µì œëŠ” í”Œë¼ì´ì›¨ì´íŠ¸ íŒ¨í„´ì˜ ê·¼ê°„ì´ ë˜ë©°, enumì€ ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ë§Œ ë§Œë“¤ì–´ì§ì„ ë³´ì¥í•œë‹¤.
ì´ëŸ° í´ë˜ìŠ¤ë¥¼ _ì¸ìŠ¤í„´ìŠ¤ í†µì œ í´ë˜ìŠ¤_ ë¼ê³  ë¶€ë¥¸ë‹¤. ì¸ìŠ¤í„´ìŠ¤ë¥¼ í†µì œí•˜ëŠ” ì´ìœ ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

* {item3}[Singleton pattern] ì ìš© ê°€ëŠ¥
* {item4}[Non-instantiable class] ìƒì„± ê°€ëŠ¥
+
[source, java]
.Example. Utility class
----
public class UtilityClass {
    private UtilityClass() { throw new AssertionError(); }
}
----
* {item17}[Immutable Class]
+
[source, java,highlight=1;3-7;!]
----
public class Complex {
    private final double re;
    private final double im;

    private Complex(double re, double im) {
        this.re = re;
        this.im = im;
    }

    public static Complex valueOf(double re, double im) {
        return new Complex(re, im);
    }
}
----
** {item34}[enum]ì´ ì´ ê¸°ë²•ì„ ì‚¬ìš©
** `equals()` ëŒ€ì‹  `==` ì—°ì‚°ì ì‚¬ìš© ê°€ëŠ¥

==== ìì‹ ì˜ ì¸ìŠ¤í„´ìŠ¤ë§Œ ë°˜í™˜í•˜ëŠ” ìƒì„±ìì™€ëŠ” ë‹¬ë¦¬, ì„œë¸Œíƒ€ì… ê°ì²´ë„ ë°˜í™˜ ê°€ëŠ¥í•˜ë‹¤

ì´ëŸ¬í•œ ìœ ì—°ì„±ì„ ì‘ìš©í•˜ë©´ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ì„ ê°ì¶œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•„ì£¼ ê°„ê²°í•œ APIê°€ ê°€ëŠ¥í•˜ë‹¤. 
{item20}[ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ í”„ë ˆì„ì›Œí¬(interface-based framework)] êµ¬í˜„ì— í•µì‹¬ ê¸°ìˆ ë¡œ, ì´ í”„ë ˆì„ì›Œí¬ì—ì„œ ì¸í„°í˜ì´ìŠ¤ëŠ” ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œì˜ ë°˜í™˜ê°’ ìë£Œí˜•ìœ¼ë¡œ ì´ìš©ëœë‹¤.

[source, java]
----
public class Collections {
    public static final Map EMPTY_MAP = new EmptyMap<>();

    public static final <K,V> Map<K,V> emptyMap() {
        return (Map<K,V>) EMPTY_MAP;
    }

    private static class EmptyMap<K,V> extends AbstractMap<K,V> implements Serializable { ... }
}
----

==== ì…ë ¥ ë§¤ê°œë³€ìˆ˜ì— ë”°ë¼ ë§¤ë²ˆ ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ê°ì²´ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤

[source, java]
.{source-enumset}[java.util.EnumSet] of OpenJDK
----
public static <E extends Enum<E>> EnumSet<E> noneOf(Class<E> elementType) {
    Enum<?>[] universe = getUniverse(elementType);
    if (universe == null)
        throw new ClassCastException(elementType + " not an enum");

    if (universe.length <= 64)
        return new RegularEnumSet<>(elementType, universe);
    else
        return new JumboEnumSet<>(elementType, universe);
}
----

`EnumSet` í´ë˜ìŠ¤ë¥¼ ë³´ë©´ ì›ì†Œì˜ ìˆ˜ì— ë”°ë¼ ë‘ ê°€ì§€ í•˜ìœ„ í´ë˜ìŠ¤ ì¤‘ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤.
ì‚¬ìš©ìëŠ” ì–´ë–¤ ê²ƒì´ ë°˜í™˜ë˜ë˜ì§€ ì•Œ í•„ìš”ê°€ ì—†ìœ¼ë©°, ë‹¨ì§€ `EnumSet` ì˜ í•˜ìœ„ í´ë˜ìŠ¤ë¥¼ ë°˜í™˜í•´ì£¼ê¸°ë§Œ í•˜ë©´ ëœë‹¤.

==== ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œë¥¼ ì‘ì„±í•˜ëŠ” ì‹œì ì—ëŠ” ë°˜í™˜í•  ê°ì²´ì˜ í´ë˜ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•Šì•„ë„ ëœë‹¤


==== ì œë„¤ë¦­ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ì½”ë“œë¥¼ ê°„ê²°í•˜ê²Œ í•´ì¤€ë‹¤.

ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì»´íŒŒì¼ëŸ¬ê°€ íƒ€ì… ì¶”ë¡ (type inference)ìœ¼ë¡œ ì œë„¤ë¦­ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤í™”ë¥¼ ê°„ê²°í•˜ê²Œ í•´ì¤€ë‹¤.

[source, java]
----
// before
Map<String, List<String>> m = new HashMap<String, List<String>>();

// after: >= 1.6
Map<String, List<String>> m = HahsMap.newInstance();

public static <K, V> HashMap<K, V> newInstance() {
    return new HashMap<K, V>();
}
----

í•˜ì§€ë§Œ, jdk7ì—ì„œ ì œê³µëœ ë‹¤ì´ì•„ëª¬ë“œ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ë©´ ì•„ë˜ì™€ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. 

[source, java]
----
Map<String, List<String>> m = new HashMap<>();
----

[.line-through gray]#ë”ì´ìƒ ì¥ì ì´ë¼ í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ 3íŒì—ì„œëŠ” ì´ ë‚´ìš©ì´ ì œê±°ëœ ê²ƒ ê°™ë‹¤.#

[#disadvantage-of-static-factory-method]
=== ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œ ë‹¨ì 

1. Static factory methodë§Œ ìˆëŠ” í´ë˜ìŠ¤ëŠ” publicì´ë‚˜ protectedë¡œ ì„ ì–¸ëœ í´ë˜ìŠ¤ê°€ ì—†ìœ¼ë¯€ë¡œ í•˜ìœ„ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.

   [source, java]
----
	public class Collections {
		Collections() {}
	}

	// inheritance
	public class CustomCollections extends Collections {
		public CustomCollections() {
			super(); // ë¶ˆê°€ëŠ¥
		}
	}
	----

   ê·¸ëŸ¬ë¯€ë¡œ, [Composition](#item16)ì„ ì‚¬ìš©í•œë‹¤.

	[source, java]
----
	// composition
	public class CustomCollections {
		private Collections collections;
	}
	----

	- ìƒì†ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°: `is-a` ê´€ê³„
	- ì»´í¬ì§€ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°: `has-a` ê´€ê³„

2. ë‹¤ë¥¸ Static factory methodì™€ ì‰½ê²Œ êµ¬ë³„í•  ìˆ˜ ì—†ë‹¤.

	API ë¬¸ì„œì— ë©”ì„œë“œì™€ ìƒì„±ìê°€ ë¶„ë¦¬ë˜ì–´ ìˆì§€ë§Œ, static íŒ©í† ë¦¬ ë©”ì„œë“œëŠ” ë‹¤ë¥¸ ë©”ì„œë“œì™€ ì„ì—¬ ì˜ êµ¬ë¶„ë˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ ì»¨ë²¤ì…˜ì„ ì •í•˜ì—¬ ë³´ë‹¤ êµ¬ë³„í•˜ê¸° ì‰½ê²Œ í•œë‹¤.

	- `valueOf`: ìì‹ ì˜ ë§¤ê°œë³€ìˆ˜ì™€ ê°™ì€ ê°’ì„ ê°–ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜
	- `of`: `valueOf` ì¤„ì¸ í˜•íƒœ, [*EnumSet*](#item32)ì—ì„œ ì‚¬ìš©
	- `getInstance`: ë§¤ê°œë³€ìˆ˜ì— ë§ëŠ” ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜, ì‹±ê¸€í†¤ì¸ ê²½ìš° í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
	- `newInstance`: ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
	- `get`*Type*: `getInstance`ì™€ ìœ ì‚¬í•˜ë‚˜ íŒ©í† ë¦¬ ë©”ì„œë“œê°€ ë‹¤ë¥¸ í´ë˜ìŠ¤ì— ìˆì„ ë•Œ ì‚¬ìš©. ì—¬ê¸°ì„œ *Type*ì€ íŒ©í† ë¦¬ ë©”ì„œë“œì—ì„œ ë°˜í™˜ë˜ëŠ” ê°ì²´ì˜ íƒ€ì…ì„ ë‚˜íƒ€ë‚¸ë‹¤.
	- `new`*Type*: `get`*Type*ì™€ ê°™ìŒ(?)

[#item02]
== ê·œì¹™ 2. ìƒì„±ìì— ë§¤ê°œë³€ìˆ˜ê°€ ë§ë‹¤ë©´ ë¹Œë”ë¥¼ ê³ ë ¤í•˜ë¼

ìƒì„±ìì— ì„ íƒì  ì¸ìê°€ ë§ì„ ë•Œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²• ì„¸ ê°€ì§€ë¥¼ ë³´ì.

==== 1. ì ì¸µì  ìƒì„±ì íŒ¨í„´(telescoping constructor pattern)

*Bad Practice ğŸ‘*

* ì´ ë°©ë²•ì€ í•„ìˆ˜ ì¸ìë§Œ ë°›ëŠ” ìƒì„±ìë¥¼ í•˜ë‚˜ ì •ì˜í•˜ê³ , ì„ íƒì  ì¸ìë¥¼ ë°›ëŠ” ìƒì„±ìë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì´ë‹¤.
* ê°ì²´ë¥¼ ìƒì„±í•  ë•ŒëŠ” ì„¤ì •í•˜ë ¤ëŠ” ì¸ì ê°¯ìˆ˜ì— ë§ëŠ” ìƒì„±ìë¥¼ ê³¨ë¼ í˜¸ì¶œí•œë‹¤.

===== ë¬¸ì œì 

- ì„¤ì •í•  í•„ìš”ê°€ ì—†ëŠ” í•„ë“œì—ë„ ì¸ìë¥¼ ì „ë‹¬í•´ì•¼ í•´ì•¼ í•œë‹¤.
- ì¸ì ìˆ˜ê°€ ëŠ˜ì–´ë‚ ìˆ˜ë¡ ê°€ë…ì„±ì´ ë–¨ì–´ì§„ë‹¤.

*Code*

[source, java]
----
public class Person {
	private final String name; // í•„ìˆ˜
	private final int age; // í•„ìˆ˜
	private final String mail;
	private final String city;
	private final String state;

	public Person(String name, int age) {
		this(name, age, "");
	}

	public Person(String name, int age, String mail) {
		this(name, age, mail, "");
	}

	public Person(String name, int age, String mail, String city) {
		this(name, age, mail, city, "");
	}

	public Person(String name, int age, String mail, String city, String state) {
		this.name = name;
		this.age = age;
		this.mail = mail;
		this.city = city;
		this.state = state;
	}
}
----

*Usage*

[source, java]
----
Person me = new Person("yeongjun.kim", "27");
Person me = new Person("yeongjun.kim", "27", "opid911@gmail.com");
----


==== 2. JavaBeans íŒ¨í„´

> *Bad Practice ğŸ‘*

- ì¸ì ì—†ëŠ” ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ì²´ë¥¼ ë§Œë“¤ê³ , setterë¡œ ê°’ ì„¤ì •í•˜ëŠ” ë°©ë²•.
- ê°ì²´ ìƒì„±ë„ ì‰½ê³ , ê°€ë…ì„±ë„ ì¢‹ë‹¤.

**ë¬¸ì œì **

- 1íšŒì˜ í•¨ìˆ˜ í˜¸ì¶œë¡œ ê°ì²´ ìƒì„±ì„ ëë‚¼ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ê°ì²´ ì¼ê´€ì„±ì´ ì¼ì‹œì‘ìœ¼ë¡œ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.
- ë³€ê²½ ë¶ˆê°€ëŠ¥ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤. í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ì¶”ê°€ êµ¬í˜„í•  ì½”ë“œê°€ ë§ì•„ì§„ë‹¤.

*Code*

[source, java]
----
@Setter
public class Person {
	private String name;
	private int age;
	private String mail;
	private String city;
	private String state;

	public Person() {}
}
----

*Usage*

[source, java]
----
Person me = new Person();
me.setName("yeongjun.kim");
me.setAge(27);
----


==== 3. Builder íŒ¨í„´

{dp-builder}[Builder íŒ¨í„´]

> ***Good Practice ğŸ‘***

- í•„ìˆ˜ ì¸ìë“¤ì„ ìƒì„±ì(ë˜ëŠ” ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œ)ì— ì „ë‹¬í•˜ì—¬ ë¹Œë” ê°ì²´ë¥¼ ë§Œë“¤ê³ , ì„ íƒì  ì¸ìë“¤ì„ ì¶”ê°€í•œ ë’¤, ë§ˆì§€ë§‰ì— `build()`ë¥¼ í˜¸ì¶œí•˜ì—¬ Immutable ê°ì²´ë¥¼ ë§Œë“œëŠ” ë°©ë²•.

	*Code*

	[source, java]
----
	public class Person {
		private final String name;
		private final int age;
		private final String mail;
		private final String city;
		private final String state;

		// ë¹Œë” ê°ì²´
		public static class Builder {
			// í•„ìˆ˜ ì¸ì
			private final String name;
			private final String age;
			// ì„ íƒì  ì¸ì - ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
			private final String mail = "";
			private final String city = "";
			private final String state = "";

			public Builder(String of, int age) {
				this.name = name;
				this.age = age;
			}

			public Builder mail(String mail) {
				this.mail = mail;
				return this;
			}

			public Builder city(String city) {
				this.city = city;
				return this;
			}

			public Builder state(String state) {
				this.state = state;
				return this;
			}

			public Person build() {
				return new Person(this);
			}
		}

		private Person(Builder builder) {
			this.name = name;
			this.age = age;
			this.mail = mail;
			this.city = city;
			this.state = state;
		}
	}
	----

	*Usage*

	[source, java]
----
	Person me = Person.Builder("yeongjun.kim", 27)
		.mail("opid911@gmail.com")
		.build();
	----

- ë¹Œë” í´ë˜ìŠ¤(*Builder*)ëŠ” ë¹Œë”ê°€ ë§Œë“œëŠ” ê°ì²´ í´ë˜ìŠ¤(*Person*)ì˜ ì •ì  ë§´ë²„ í´ë˜ìŠ¤ë¡œ ì •ì˜í•œë‹¤([ê·œì¹™ 22](#item22)).

	[source, java]
----
	public class Person {
		public static class Builder {
			...
		}
	}
	----

- ë¶ˆë³€ì‹ì„ ì ìš©í•  ìˆ˜ ìˆìœ¼ë©°, build()ì—ì„œ ë¶ˆë³€ì‹ì´ ìœ„ë°˜ë˜ì—ˆëŠ”ì§€ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤.

	[source, java]
----
	public class Person {
		public static class Builder {
			...
			public Person build() {
				Person result = new Person(this);
				if(/* resultì˜ ê°’ ê²€ì‚¬ */) {
					throw new IllegalStateException(/* ìœ„ë°˜ ì›ì¸ */);
				}
				return result;
			}
		}
	}
	----

	- ë¹Œë” ê°ì²´ì—ì„œ ì‹¤ì œ ê°ì²´ë¡œ ì¸ìê°€ ë³µì‚¬ëœ ë‹¤ìŒì— ë¶ˆë³€ì‹ë“¤ì„ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒ, ê·¸ë¦¬ê³  ê·¸ ë¶ˆë³€ì‹ì„ ë¹Œë” ê°ì²´ì˜ í•„ë“œê°€ ì•„ë‹ˆë¼ ì‹¤ì œ ê°ì²´ì˜ í•„ë“œë¥¼ ë‘ê³  ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì€ ì¤‘ìš”í•˜ë‹¤([ê·œì¹™ 39](#item39)).
	- ë¶ˆë³€ì‹ì„ ìœ„ë°˜í•œ ê²½ìš°, *build()*ëŠ” *IllegalStateException*ì„ ë˜ì ¸ì•¼ í•œë‹¤([ê·œì¹™ 60](#item60)).
	- ì˜ˆì™¸ ê°ì²´ë¥¼ ì‚´í´ë³´ë©´ ì–´ë–¤ ë¶ˆë³€ì‹ì„ ìœ„ë°˜í–ˆëŠ”ì§€ ì•Œì•„ë‚¼ ìˆ˜ë„ ìˆì–´ì•¼ í•œë‹¤([ê·œì¹™ 63](#item63)).

	*cf. ë¶ˆë³€ì‹ì„ ê°•ì œí•˜ëŠ” ë°©ë²•*

	- ë¶ˆë³€ì‹ì´ ì ìš©ë  ê°’ ì „ë¶€ë¥¼ ì¸ìë¡œ ë°›ëŠ” setterë¥¼ ì •ì˜í•˜ëŠ” ë°©ë²•.
	- setterëŠ” ë¶ˆë³€ì‹ì´ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë©´ *IllegalArgumentException*ì„ ë˜ì§.
	- build()ê°€ í˜¸ì¶œë˜ê¸° ì „ì— ë¶ˆë³€ì‹ì„ ê¹¨ëœ¨ë¦¬ëŠ” ì¸ìê°€ ì „ë‹¬ë˜ì—ˆë‹¤ëŠ” ê²ƒì„ ì‹ ì†í•˜ê²Œ ì•Œ ìˆ˜ ìˆëŠ” ì¥ì .

	[source, java]
----
	public class Person {
		...

		public static class Builder {

			public Builder setNameAndAge(String name, int ate) {
				if(name == null) {
					throw new IllegalArgumentException();
				}
				return this;
			}

			...

			public Person build() {
				return new Person(this);
			}
		}
		...
	}
	----

- ë©”ì„œë“œë§ˆë‹¤ í•˜ë‚˜ì”©, í•„ìš”í•œ ë§Œí¼ varargs ì¸ìë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

	[source, java]
----
	public class Person {
		public static class Builder {
			public Builder names(String... names) {
				this.names = names;
				return this;
			}

			public Builder foramily(String... names) {
				this.farther = names[0];
				this.marther = names[1];
				return this;
			}
		}
		...
	}
	----

- ìœ ì—°í•˜ë‹¤. (e.g. ê°ì²´ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œë§ˆë‹¤ ìë™ì ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” ì¼ë ¨ë²ˆí˜¸ ê°™ì€ ê²ƒì„ ì±„ìš¸ ìˆ˜ ìˆë‹¤)
- ì¸ìê°€ ì„¤ì •ëœ ë¹Œë”ëŠ” í›Œë¥­í•œ [Abstract Factory][dp-abstract-factory]ë‹¤. JDK1.5 ì´ìƒì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì œë„¤ë¦­ ìë£Œí˜• í•˜ë‚˜ë©´ ì–´ë–¤ ìë£Œí˜•ì˜ ê°ì²´ë¥¼ ë§Œë“œëŠ” ë¹Œë”ëƒì˜ ê´€ê³„ ì—†ì´ ëª¨ë“  ë¹Œë”ì— ì ìš©í•  ìˆ˜ ìˆë‹¤.

	[source, java]
----
	public interface Builder<T> {
		public T build();
	}
	----

	[source, java]
----
	public class Person {
		public static class Builder implements Builder<Person> {
			...
			public Person build() {
				return new Person(this);
			}
		}
	}
	----

	**e.g.** *Code at package `java.util.stream`*

	[source, java]
----
	Stream.builder().add(1).add(2).add(3).build();
	----

- ë¹Œë” ê°ì²´ë¥¼ ì¸ìë¡œ ë°›ëŠ” ë©”ì„œë“œëŠ” ë³´í†µ *í•œì •ì  ì™€ì¼ë“œì¹´ë“œ ìë£Œí˜•~bounded wildcard type~*ì„ í†µí•´ ì¸ìì˜ ìë£Œí˜•ì„ ì œí•œí•œë‹¤([ê·œì¹™ 28](#items28)).

	[source, java]
----
	Tree buildTree(Builder<? extends Node> nodeBuilder) {...}
	----

- ìë°”ê°€ ì œê³µí•˜ëŠ” ì¶”ìƒì  íŒ©í† ë¦¬ë¡œëŠ” Class ê°ì²´ê°€ ìˆìœ¼ë©°, ì´ ê°ì²´ì˜ *newInstance()* ê°€ build ë©”ì„œë“œ êµ¬ì‹¤ì„ í•œë‹¤.

	**í•˜ì§€ë§Œ,** newInstance()ëŠ” í•­ìƒ ë¬´ì¸ì ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ë ¤ í•˜ëŠ”ë°, ë¬¸ì œëŠ” ê·¸ëŸ° ìƒì„±ìê°€ ì—†ì„ ìˆ˜ë„ ìˆë‹¤ëŠ” ê²ƒ. TO-DO

**ë¬¸ì œì **

- ë¹Œë” ê°ì²´ë¥¼ ë§Œë“œëŠ” ì˜¤ë²„í—¤ë“œê°€ ë¬¸ì œê°€ ë  ìˆ˜ ìˆë‹¤(ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ìƒí™©). ê·¸ëŸ¬ë‹ˆ ì¸ì ê°¯ìˆ˜ê°€ í†µì œí•  ìˆ˜ ì—†ì„ ì •ë„ë¡œ ë§ì•„ì§€ë§Œ ë¹Œë” íŒ¨í„´ì„ ì ìš©í•˜ì.

#### ìš”ì•½

ë¹Œë” íŒ¨í„´ì€ ì¸ìê°€ ë§ì€ ìƒì„±ìë‚˜ ì •ì  íŒ©í„°ë¦¬ê°€ í•„ìš”í•œ í´ë˜ìŠ¤ë¥¼ ì„¤ê³„í•  ë•Œ, íŠ¹ì‹œ ëŒ€ë¶€ë¶„ì˜ ì¸ìê°€ ì„ íƒì  ì¸ìì¸ ìƒí™©ì— ìœ ìš©í•˜ë‹¤.

**cf.** *Code with [Lombok](https://projectlombok.org/features/Builder.html)* - ì •ì  íŒ©í„°ë¦¬ ë©”ì„œë“œë¡œ êµ¬í˜„

[source, java]
----
@Value // immutable(private, final ì ìš©)
@Builder
public class Person {
	String name;
	int age;
	String mail;
	String city;
	String state;
}
----

[#item3]
== ê·œì¹™ 3. private ìƒì„±ìë‚˜ ì—´ê±° íƒ€ì…ìœ¼ë¡œ ì‹±ê¸€í„´ì„ì„ ë³´ì¦í•˜ë¼

[#item4]
== ê·œì¹™ 4. ì¸ìŠ¤í„´ìŠ¤í™”ë¥¼ ë§‰ìœ¼ë ¤ê±°ë“  private ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ë¼

[#item5]
== ê·œì¹™ 5. ìì›ì„ ì§ì ‘ ëª…ì‹œí•˜ì§€ ë§ê³  ì˜ì¡´ ê°ì²´ ì£¼ì…ì„ ì‚¬ìš©í•˜ë¼

[#item6]
== ê·œì¹™ 6. ë¶ˆí•„ìš”í•œ ê°ì²´ ìƒì„±ì„ í”¼í•˜ë¼

[#item7]
== ê·œì¹™ 7. ë‹¤ ì“´ ê°ì²´ ì°¸ì¡°ëŠ” í•´ì œí•˜ë¼

[#item8]
== ê·œì¹™ 8. finalizerì™€ cleaner ì‚¬ìš©ì„ í”¼í•˜ë¼

[#item9]
== ê·œì¹™ 9. try-finally ë³´ë‹¤ëŠ” try-with-resourcesë¥¼ ì‚¬ìš©í•˜ë¼

